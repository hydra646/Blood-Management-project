{% extends 'core/base.html' %}
{% load static %}
{% load i18n %}
{% block content %}
<div class="row gx-4">
  <div class="col-lg-4">
    <div class="profile-card mb-4 text-center">
      <img src="{% if user.profile_photo %}{{ user.profile_photo.url }}{% else %}{% static 'img/default-avatar.png' %}{% endif %}" alt="avatar" class="profile-avatar mb-2">
      <h5 class="mb-0">{{ user.get_full_name|default:user.username }}</h5>
      <div class="small-muted">{{ user.email }}</div>
      <div class="mt-3 text-start px-2">
  <div><strong>{% trans "Phone" %}:</strong> {{ user.phone|default:'—' }}</div>
  <div><strong>{% trans "City" %}:</strong> {{ user.city|default:'—' }}</div>
      </div>
      <div class="mt-3 px-3">
  <a class="btn btn-primary w-100 mb-2" href="{% url 'create-request' %}">{% trans "Place Blood Request" %}</a>
  <a class="btn btn-outline-secondary w-100" href="{% url 'profile' %}">{% trans "Edit Profile" %}</a>
      </div>
    </div>
  </div>
  <div class="col-lg-8">
    <div class="card mb-3">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h4 class="mb-0">{% trans "Your Requests" %}</h4>
          <a class="btn btn-sm btn-outline-primary" href="{% url 'my-requests' %}">{% trans "View all" %}</a>
        </div>
        <div class="table-responsive">
          <table class="table table-sm">
            <thead><tr><th>{% trans "Date" %}</th><th>{% trans "Group" %}</th><th>{% trans "Units" %}</th><th>{% trans "City" %}</th><th>{% trans "Status" %}</th></tr></thead>
            <tbody>
              {% for r in requests %}
              <tr>
                <td>{{ r.created_at|date:"Y-m-d H:i" }}</td>
                <td>{{ r.blood_group }}</td>
                <td>{{ r.units }}</td>
                <td>{{ r.city }}</td>
                <td>
                  {% if r.status == 'pending' %}
                    <span class="badge bg-warning text-dark">{% trans "Pending" %}</span>
                  {% elif r.status == 'approved' %}
                    <span class="badge bg-success">{% trans "Approved" %}</span>
                  {% else %}
                    <span class="badge bg-danger">{% trans "Rejected" %}</span>
                  {% endif %}
                </td>
              </tr>
              {% empty %}
              <tr><td colspan="5">{% trans "No requests yet." %}</td></tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
